package Test;

import static org.junit.Assert.*;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

import org.junit.Test;
import org.w3c.dom.Document;

import Application.XmlHelper;

public class TestXmlHelper {

	@Test
	public void testGetXmlDocument() 
	{
		String xml = "<DGX><SIGNONMSGSRSV1><SONRS><STATUS><CODE>0</CODE><SEVERITY>INFO</SEVERITY></STATUS><DTSERVER></DTSERVER><LANGUAGE></LANGUAGE></SONRS></SIGNONMSGSRSV1><GLBLMNSVCMSGSRSV1><REGNLISTTRNRS><STATUS><CODE>0</CODE><SEVERITY>INFO</SEVERITY></STATUS><REGNLISTRS><USERRS><USERID>unit4test</USERID><PFLRS><PROD_NME>EnterpriseManagement</PROD_NME><NTFC_LVL>level2</NTFC_LVL><REGNRS><DUNS_NBR>225314921</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>UNIT4BUSINESSSOFTWARELTD</PRIM_NME><STAT_CD>10</STAT_CD><STAT_DESC>active</STAT_DESC><LAST_UPD_DT>2013-05-01T22:44:02-04:00</LAST_UPD_DT><RNEW_DT>2014-05-02T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>230782260</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>SIGNATUREINDUSTRIESLTD</PRIM_NME><STAT_CD>60</STAT_CD><STAT_DESC>failed</STAT_DESC><LAST_UPD_DT>2013-05-01T11:19:33-04:00</LAST_UPD_DT><RNEW_DT>2014-05-02T00:00:00-04:00</RNEW_DT></REGNRS></PFLRS><PFLRS><PROD_NME>EnterpriseManagement</PROD_NME><NTFC_LVL>level3</NTFC_LVL><REGNRS><DUNS_NBR>221153591</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME></PRIM_NME><STAT_CD>20</STAT_CD><STAT_DESC>pending</STAT_DESC><LAST_UPD_DT>2013-05-03T07:05:39-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>221574713</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>STANDARDLIFEEUROPEANPRIVATEEQUITYTRUSTPLC</PRIM_NME><STAT_CD>10</STAT_CD><STAT_DESC>active</STAT_DESC><LAST_UPD_DT>2013-05-03T07:20:33-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>227141223</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>F&CGLOBALSMALLERCOMPANIESPLC</PRIM_NME><STAT_CD>10</STAT_CD><STAT_DESC>active</STAT_DESC><LAST_UPD_DT>2013-05-03T07:20:38-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>289977530</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>BLACKROCKSMALLERCOMPANIESTRUSTPLC</PRIM_NME><STAT_CD>10</STAT_CD><STAT_DESC>active</STAT_DESC><LAST_UPD_DT>2013-05-03T07:20:38-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>290250406</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>LOWLANDINVESTMENTCOPLC</PRIM_NME><STAT_CD>10</STAT_CD><STAT_DESC>active</STAT_DESC><LAST_UPD_DT>2013-05-03T07:06:32-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>293432092</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>JPMORGANJAPANESEINVESTMENTTRUSTPLC</PRIM_NME><STAT_CD>10</STAT_CD><STAT_DESC>active</STAT_DESC><LAST_UPD_DT>2013-05-03T05:31:40-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>295215255</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>ANGLO-EASTERNPLANTATIONSPLC</PRIM_NME><STAT_CD>20</STAT_CD><STAT_DESC>pending</STAT_DESC><LAST_UPD_DT>2013-05-03T07:53:33-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>296240179</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>MOTHERCAREPLC</PRIM_NME><STAT_CD>20</STAT_CD><STAT_DESC>pending</STAT_DESC><LAST_UPD_DT>2013-05-03T07:05:41-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>525251716</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>MEARSGROUPPLC</PRIM_NME><STAT_CD>10</STAT_CD><STAT_DESC>active</STAT_DESC><LAST_UPD_DT>2013-05-03T07:20:32-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS><REGNRS><DUNS_NBR>779158224</DUNS_NBR><CTRY_CD>GB</CTRY_CD><PRIM_NME>XCHANGINGPLC</PRIM_NME><STAT_CD>10</STAT_CD><STAT_DESC>active</STAT_DESC><LAST_UPD_DT>2013-05-03T05:42:30-04:00</LAST_UPD_DT><RNEW_DT>2014-05-04T00:00:00-04:00</RNEW_DT></REGNRS></PFLRS></USERRS></REGNLISTRS></REGNLISTTRNRS></GLBLMNSVCMSGSRSV1></DGX>";
		
		Document doc = XmlHelper.getXmlDocument(xml);
		
		assertNotNull("Document is returned.", doc);
	}

	@Test
	public void testGetDateFromXmlString()
	{
		String testDate = "2013-05-04T06:28:16-04:00";
		Date test = new Date();
		try
		{
			test = XmlHelper.getDateFromXmlString(testDate);
		}
		catch(ParseException e)
		{}
		
		SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
		
		assertEquals("Date's don't match", "2013-05-04 06:28:16", formatter.format(test));
		
	}
	
	@Test
	public void testGetIntegerFromXmlString()
	{
		assertEquals("Check 1 is correct", 1, XmlHelper.getIntegerFromXmlString("1"));
		assertEquals("Check emptystring is 0", 0, XmlHelper.getIntegerFromXmlString(""));

	}
	
	@Test
	public void testGetDoubleAsString()
	{
		assertEquals("Check 100,000,000.33 returns correctly ", "100000000.33", XmlHelper.getDoubleAsString(100000000.33));
		assertEquals("Check 100,000,000.333 returns correctly ", "100000000.33", XmlHelper.getDoubleAsString(100000000.333));	
		assertEquals("Check 100,000,000.336 returns correctly ", "100000000.34", XmlHelper.getDoubleAsString(100000000.336));	
		assertEquals("Check 100,000,000,000 returns correctly ", "100000000000", XmlHelper.getDoubleAsString(100000000000.0));
	}
}
