with s_parent as (select gen_id from accounts union select distinct gen_id from int_accounts),wholeSet as (select int_accounts.* from int_accounts where (int_accounts.parent in (select gen_id from s_parent) or int_accounts.parent is null)) insert into  stg_accounts select * from wholeSet;
with s_parent as (select gen_id from criteria union select distinct gen_id from int_criteria),wholeSet as (select int_criteria.* from int_criteria where (int_criteria.parent in (select gen_id from s_parent) or int_criteria.parent is null)) insert into  stg_criteria select * from wholeSet;
with s_parent_id as (select gen_id from allocation union select distinct gen_id from int_allocation),wholeSet as (select int_allocation.* from int_allocation where (int_allocation.parent_id in (select gen_id from s_parent_id) or int_allocation.parent_id is null)) insert into  stg_allocation select * from wholeSet;
with s_parent_id as (select gen_id from business_area union select distinct gen_id from int_business_area),wholeSet as (select int_business_area.* from int_business_area where (int_business_area.parent_id in (select gen_id from s_parent_id) or int_business_area.parent_id is null)) insert into  stg_business_area select * from wholeSet;
with s_parent_id as (select gen_id from code union select distinct gen_id from int_code),wholeSet as (select int_code.* from int_code where (int_code.parent_id in (select gen_id from s_parent_id) or int_code.parent_id is null)) insert into  stg_code select * from wholeSet;
with s_parent_id as (select gen_id from connection_type union select distinct gen_id from int_connection_type),wholeSet as (select int_connection_type.* from int_connection_type where (int_connection_type.parent_id in (select gen_id from s_parent_id) or int_connection_type.parent_id is null)) insert into  stg_connection_type select * from wholeSet;
with s_parent_id as (select gen_id from dataset union select distinct gen_id from int_dataset),wholeSet as (select int_dataset.* from int_dataset where (int_dataset.parent_id in (select gen_id from s_parent_id) or int_dataset.parent_id is null)) insert into  stg_dataset select * from wholeSet;
with s_parent_id as (select gen_id from t_comment union select distinct gen_id from int_t_comment),wholeSet as (select int_t_comment.* from int_t_comment where (int_t_comment.parent_id in (select gen_id from s_parent_id) or int_t_comment.parent_id is null)) insert into  stg_t_comment select * from wholeSet;
with s_parent_id as (select gen_id from t_feproperty union select distinct gen_id from int_t_feproperty),wholeSet as (select int_t_feproperty.* from int_t_feproperty where (int_t_feproperty.parent_id in (select gen_id from s_parent_id) or int_t_feproperty.parent_id is null)) insert into  stg_t_feproperty select * from wholeSet;
with wholeSet as (select int_annotation.* from int_annotation) insert into  stg_annotation select * from wholeSet;
with wholeSet as (select int_calc_util.* from int_calc_util) insert into  stg_calc_util select * from wholeSet;
with wholeSet as (select int_kpi.* from int_kpi) insert into  stg_kpi select * from wholeSet;
with s_accounts as (select gen_id from accounts union select distinct gen_id from int_accounts),s_dataset as (select gen_id from dataset union select distinct gen_id from int_dataset),wholeSet as (select int_fact_data.* from int_fact_data where (int_fact_data.accounts in (select gen_id from s_accounts) or int_fact_data.accounts is null) and (int_fact_data.dataset in (select gen_id from s_dataset) or int_fact_data.dataset is null)) insert into  stg_fact_data select * from wholeSet;
with s_accounts as (select gen_id from accounts union select distinct gen_id from int_accounts),s_dataset as (select gen_id from dataset union select distinct gen_id from int_dataset),wholeSet as (select int_fact_data_daily_snapshot.* from int_fact_data_daily_snapshot where (int_fact_data_daily_snapshot.accounts in (select gen_id from s_accounts) or int_fact_data_daily_snapshot.accounts is null) and (int_fact_data_daily_snapshot.dataset in (select gen_id from s_dataset) or int_fact_data_daily_snapshot.dataset is null)) insert into  stg_fact_data_daily_snapshot select * from wholeSet;
with s_accounts as (select gen_id from accounts union select distinct gen_id from int_accounts),s_dataset as (select gen_id from dataset union select distinct gen_id from int_dataset),wholeSet as (select int_fact_data_monthly_snapshot.* from int_fact_data_monthly_snapshot where (int_fact_data_monthly_snapshot.accounts in (select gen_id from s_accounts) or int_fact_data_monthly_snapshot.accounts is null) and (int_fact_data_monthly_snapshot.dataset in (select gen_id from s_dataset) or int_fact_data_monthly_snapshot.dataset is null)) insert into  stg_fact_data_monthly_snapshot select * from wholeSet;
with s_dataset as (select gen_id from dataset union select distinct gen_id from int_dataset),s_criteria as (select gen_id from criteria union select distinct gen_id from int_criteria),s_connection_type as (select gen_id from connection_type union select distinct gen_id from int_connection_type),wholeSet as (select int_fact_criteria.* from int_fact_criteria where (int_fact_criteria.dataset in (select gen_id from s_dataset) or int_fact_criteria.dataset is null) and (int_fact_criteria.criteria in (select gen_id from s_criteria) or int_fact_criteria.criteria is null) and (int_fact_criteria.connection_type in (select gen_id from s_connection_type) or int_fact_criteria.connection_type is null)) insert into  stg_fact_criteria select * from wholeSet;
with s_t_feproperty as (select gen_id from t_feproperty union select distinct gen_id from int_t_feproperty),s_kpi as (select kpi_id from kpi union select distinct kpi_id from int_kpi),wholeSet as (select int_f_feproperty.* from int_f_feproperty,s_kpi where (int_f_feproperty.t_feproperty in (select gen_id from s_t_feproperty) or int_f_feproperty.t_feproperty is null) and int_f_feproperty.kpi=s_kpi.kpi_id) insert into  stg_f_feproperty select * from wholeSet;
with s_type as (select gen_id from t_comment union select distinct gen_id from int_t_comment),wholeSet as (select int_comment.* from int_comment where (int_comment.type in (select gen_id from s_type) or int_comment.type is null)) insert into  stg_comment select * from wholeSet;
with wholeSet as (select int_exie_fact_usage.* from int_exie_fact_usage) insert into  stg_exie_fact_usage select * from wholeSet;
with wholeSet as (select int_generator_version.* from int_generator_version) insert into  stg_generator_version select * from wholeSet;
