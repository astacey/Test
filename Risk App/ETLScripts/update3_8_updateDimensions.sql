 update accounts  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), ''),agr_no = CASE WHEN imp.agr_no = '' THEN NULL ELSE imp.agr_no END,ch_no = CASE WHEN imp.ch_no = '' THEN NULL ELSE imp.ch_no END,duns_no = CASE WHEN imp.duns_no = '' THEN NULL ELSE imp.duns_no END,status = CASE WHEN imp.status = '' THEN NULL ELSE imp.status END,DnB_STATUS = CASE WHEN imp.DnB_STATUS = '' THEN NULL ELSE imp.DnB_STATUS END,account_group_code = CASE WHEN imp.account_group_code = '' THEN NULL ELSE imp.account_group_code END,account_group_name = CASE WHEN imp.account_group_name = '' THEN NULL ELSE imp.account_group_name END,vertical_market = CASE WHEN imp.vertical_market = '' THEN NULL ELSE imp.vertical_market END,experian_no = CASE WHEN imp.experian_no = '' THEN NULL ELSE imp.experian_no END,EXPERIAN_LEGAL_STATUS = CASE WHEN imp.EXPERIAN_LEGAL_STATUS = '' THEN NULL ELSE imp.EXPERIAN_LEGAL_STATUS END,EXPERIAN_REGISTRATION_STATUS = CASE WHEN imp.EXPERIAN_REGISTRATION_STATUS = '' THEN NULL ELSE imp.EXPERIAN_REGISTRATION_STATUS END,DnB_Default_Currency_Code = CASE WHEN imp.DnB_Default_Currency_Code = '' THEN NULL ELSE imp.DnB_Default_Currency_Code END,DnB_Credit_Recommendation_Currency_Code = CASE WHEN imp.DnB_Credit_Recommendation_Currency_Code = '' THEN NULL ELSE imp.DnB_Credit_Recommendation_Currency_Code END,DnB_Rating = CASE WHEN imp.DnB_Rating = '' THEN NULL ELSE imp.DnB_Rating END,DnB_Address_Line_1 = CASE WHEN imp.DnB_Address_Line_1 = '' THEN NULL ELSE imp.DnB_Address_Line_1 END,DnB_Address_Line_2 = CASE WHEN imp.DnB_Address_Line_2 = '' THEN NULL ELSE imp.DnB_Address_Line_2 END,DnB_Address_Line_3 = CASE WHEN imp.DnB_Address_Line_3 = '' THEN NULL ELSE imp.DnB_Address_Line_3 END,DnB_Address_Line_4 = CASE WHEN imp.DnB_Address_Line_4 = '' THEN NULL ELSE imp.DnB_Address_Line_4 END,DnB_Address_Town = CASE WHEN imp.DnB_Address_Town = '' THEN NULL ELSE imp.DnB_Address_Town END,DnB_Address_County = CASE WHEN imp.DnB_Address_County = '' THEN NULL ELSE imp.DnB_Address_County END,DnB_Address_Country_Code = CASE WHEN imp.DnB_Address_Country_Code = '' THEN NULL ELSE imp.DnB_Address_Country_Code END,DnB_Address_Country_Description = CASE WHEN imp.DnB_Address_Country_Description = '' THEN NULL ELSE imp.DnB_Address_Country_Description END,DnB_Address_Post_Code = CASE WHEN imp.DnB_Address_Post_Code = '' THEN NULL ELSE imp.DnB_Address_Post_Code END,DnB_Name = CASE WHEN imp.DnB_Name = '' THEN NULL ELSE imp.DnB_Name END,DnB_Match_Grade = CASE WHEN imp.DnB_Match_Grade = '' THEN NULL ELSE imp.DnB_Match_Grade END,DnB_Confidence_Code = CASE WHEN imp.DnB_Confidence_Code = '' THEN NULL ELSE imp.DnB_Confidence_Code END,DnB_Original_Matched_Duns_No = CASE WHEN imp.DnB_Original_Matched_Duns_No = '' THEN NULL ELSE imp.DnB_Original_Matched_Duns_No END from accounts, stg_accounts imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = accounts.gen_id;
 update accounts  set parent=d_1.accounts_id from accounts, stg_accounts imp ,accounts  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = accounts.gen_id AND d_1.gen_id = imp.parent;
 update allocation  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') from allocation, stg_allocation imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = allocation.gen_id;
 update allocation  set parent_id=d_1.allocation_id from allocation, stg_allocation imp ,allocation  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = allocation.gen_id AND d_1.gen_id = imp.parent_id;
 update business_area  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') from business_area, stg_business_area imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = business_area.gen_id;
 update business_area  set parent_id=d_1.business_area_id from business_area, stg_business_area imp ,business_area  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = business_area.gen_id AND d_1.gen_id = imp.parent_id;
 update code  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), ''),icon = CASE WHEN imp.icon = '' THEN NULL ELSE imp.icon END from code, stg_code imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = code.gen_id;
 update code  set parent_id=d_1.code_id from code, stg_code imp ,code  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = code.gen_id AND d_1.gen_id = imp.parent_id;
 update connection_type  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), ''),is_multiple = imp.is_multiple from connection_type, stg_connection_type imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = connection_type.gen_id;
 update connection_type  set parent_id=d_1.connection_type_id from connection_type, stg_connection_type imp ,connection_type  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = connection_type.gen_id AND d_1.gen_id = imp.parent_id;
 update criteria  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') from criteria, stg_criteria imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = criteria.gen_id;
 update criteria  set parent=d_1.criteria_id from criteria, stg_criteria imp ,criteria  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = criteria.gen_id AND d_1.gen_id = imp.parent;
 update dataset  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), ''),filter_description = CASE WHEN imp.filter_description = '' THEN NULL ELSE imp.filter_description END,DailySnapshot = imp.DailySnapshot,is_filterable = imp.is_filterable,filter_trend_description = CASE WHEN imp.filter_trend_description = '' THEN NULL ELSE imp.filter_trend_description END from dataset, stg_dataset imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = dataset.gen_id;
 update dataset  set parent_id=d_1.dataset_id from dataset, stg_dataset imp ,dataset  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = dataset.gen_id AND d_1.gen_id = imp.parent_id;
 update t_comment  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') from t_comment, stg_t_comment imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = t_comment.gen_id;
 update t_comment  set parent_id=d_1.t_comment_id from t_comment, stg_t_comment imp ,t_comment  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = t_comment.gen_id AND d_1.gen_id = imp.parent_id;
 update t_feproperty  set name = REPLACE(REPLACE(REPLACE(REPLACE(imp.name, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') from t_feproperty, stg_t_feproperty imp  where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = t_feproperty.gen_id;
 update t_feproperty  set parent_id=d_1.t_feproperty_id from t_feproperty, stg_t_feproperty imp ,t_feproperty  d_1 where  REPLACE(REPLACE(REPLACE(REPLACE(imp.gen_id, CHAR(9), ''), CHAR(10), ''), CHAR(12), ''), CHAR(13), '') = t_feproperty.gen_id AND d_1.gen_id = imp.parent_id;
