 delete orig from int_annotation orig;
 delete orig from int_calc_util orig;
 delete orig from int_kpi orig;
with s_parent as (select gen_id from accounts union select distinct gen_id from stg_accounts) delete orig from int_accounts orig where (orig.parent in (select gen_id from s_parent) or orig.parent is null);
with s_parent as (select gen_id from criteria union select distinct gen_id from stg_criteria) delete orig from int_criteria orig where (orig.parent in (select gen_id from s_parent) or orig.parent is null);
with s_parent_id as (select gen_id from allocation union select distinct gen_id from stg_allocation) delete orig from int_allocation orig where (orig.parent_id in (select gen_id from s_parent_id) or orig.parent_id is null);
with s_parent_id as (select gen_id from business_area union select distinct gen_id from stg_business_area) delete orig from int_business_area orig where (orig.parent_id in (select gen_id from s_parent_id) or orig.parent_id is null);
with s_parent_id as (select gen_id from code union select distinct gen_id from stg_code) delete orig from int_code orig where (orig.parent_id in (select gen_id from s_parent_id) or orig.parent_id is null);
with s_parent_id as (select gen_id from connection_type union select distinct gen_id from stg_connection_type) delete orig from int_connection_type orig where (orig.parent_id in (select gen_id from s_parent_id) or orig.parent_id is null);
with s_parent_id as (select gen_id from dataset union select distinct gen_id from stg_dataset) delete orig from int_dataset orig where (orig.parent_id in (select gen_id from s_parent_id) or orig.parent_id is null);
with s_parent_id as (select gen_id from t_comment union select distinct gen_id from stg_t_comment) delete orig from int_t_comment orig where (orig.parent_id in (select gen_id from s_parent_id) or orig.parent_id is null);
with s_parent_id as (select gen_id from t_feproperty union select distinct gen_id from stg_t_feproperty) delete orig from int_t_feproperty orig where (orig.parent_id in (select gen_id from s_parent_id) or orig.parent_id is null);
 delete orig from int_exie_fact_usage orig;
 delete orig from int_generator_version orig;
with s_accounts as (select gen_id from accounts union select distinct gen_id from stg_accounts),s_dataset as (select gen_id from dataset union select distinct gen_id from stg_dataset) delete orig from int_fact_data orig where (orig.accounts in (select gen_id from s_accounts) or orig.accounts is null) and (orig.dataset in (select gen_id from s_dataset) or orig.dataset is null);
with s_accounts as (select gen_id from accounts union select distinct gen_id from stg_accounts),s_dataset as (select gen_id from dataset union select distinct gen_id from stg_dataset) delete orig from int_fact_data_daily_snapshot orig where (orig.accounts in (select gen_id from s_accounts) or orig.accounts is null) and (orig.dataset in (select gen_id from s_dataset) or orig.dataset is null);
with s_accounts as (select gen_id from accounts union select distinct gen_id from stg_accounts),s_dataset as (select gen_id from dataset union select distinct gen_id from stg_dataset) delete orig from int_fact_data_monthly_snapshot orig where (orig.accounts in (select gen_id from s_accounts) or orig.accounts is null) and (orig.dataset in (select gen_id from s_dataset) or orig.dataset is null);
with s_dataset as (select gen_id from dataset union select distinct gen_id from stg_dataset),s_criteria as (select gen_id from criteria union select distinct gen_id from stg_criteria),s_connection_type as (select gen_id from connection_type union select distinct gen_id from stg_connection_type) delete orig from int_fact_criteria orig where (orig.dataset in (select gen_id from s_dataset) or orig.dataset is null) and (orig.criteria in (select gen_id from s_criteria) or orig.criteria is null) and (orig.connection_type in (select gen_id from s_connection_type) or orig.connection_type is null);
with s_t_feproperty as (select gen_id from t_feproperty union select distinct gen_id from stg_t_feproperty),s_kpi as (select kpi_id from kpi union select distinct kpi_id from stg_kpi) delete orig from s_kpi,int_f_feproperty orig where (orig.t_feproperty in (select gen_id from s_t_feproperty) or orig.t_feproperty is null) and orig.kpi=s_kpi.kpi_id;
with s_type as (select gen_id from t_comment union select distinct gen_id from stg_t_comment) delete orig from int_comment orig where (orig.type in (select gen_id from s_type) or orig.type is null);
